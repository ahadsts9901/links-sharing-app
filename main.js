const firebaseConfig={apiKey:"AIzaSyDDkH9pqIcdWmRlXHdyC2G0z0Lhlej5dCw",authDomain:"links-sharing-b9c2a.firebaseapp.com",projectId:"links-sharing-b9c2a",storageBucket:"links-sharing-b9c2a.appspot.com",messagingSenderId:"606062782904",appId:"1:606062782904:web:c4a1a96a5f42be8236c74d"};firebase.initializeApp(firebaseConfig);var db=firebase.firestore();let linkSnapshotListener,section=document.querySelector(".section");function addLink(e){e.preventDefault();let t=document.querySelector(".input").value;db.collection("users").add({link:t,timestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(e=>{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"success",title:"Added successfully"}),renderLink()}).catch(e=>{console.error("Error adding document: ",e)}),document.querySelector(".input").value=""}let isRenderingLinks=!1;function renderLink(){isRenderingLinks||(isRenderingLinks=!0,linkSnapshotListener&&linkSnapshotListener(),linkSnapshotListener=db.collection("users").orderBy("timestamp","desc").onSnapshot(function(e){section.innerHTML="",e.empty?section.innerHTML="<div class='blue'>No Links found</div>":e.forEach(function(e){var t=e.data();let n=document.createElement("div");if(n.className="rowScroll",section.appendChild(n),/^(ftp|http|https):\/\/[^ "]+$/.test(t.link)){let e=document.createElement("a");e.className="scrollX",e.setAttribute("target","_blank"),e.setAttribute("href",`${t.link}`),e.innerText=t.link,n.appendChild(e)}else{let e=document.createElement("p");e.className="scrollX",e.innerText=t.link,n.appendChild(e)}let i=document.createElement("div");i.className+=" small-container",n.appendChild(i);let o=t.timestamp?t.timestamp.toDate():new Date,r=document.createElement("p");r.className+=" small",r.innerText=moment(o).fromNow(),i.appendChild(r);let s=document.createElement("p");s.className="bi bi-trash-fill",s.className+=" small",s.addEventListener("click",()=>deleteLink(e.id)),i.appendChild(s)}),isRenderingLinks=!1},function(e){console.log("Error getting documents: ",e),isRenderingLinks=!1}))}async function deleteLink(e){const{value:t}=await Swal.fire({title:"Enter Your Password",input:"password",inputLabel:"Password",inputPlaceholder:"Enter Your Password",confirmButtonColor:"#212121",confirmButtonText:"Delete URL",inputAttributes:{maxlength:10,autocapitalize:"off",autocorrect:"off"}});"delete123"===t?Swal.fire({title:"Do You Want To Delete It ?",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Don't Delete",confirmButtonColor:"#212121",denyButtonColor:"#212121"}).then(t=>{if(t.isConfirmed){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"success",title:"Deleted successfully"}),db.collection("users").doc(e).delete().then(()=>{renderLink()}).catch(e=>{console.error("Error deleting document: ",e)})}else renderLink()}):Swal.fire({icon:"error",title:"Access Denied",confirmButtonText:"OK",confirmButtonColor:"#212121"})}async function deleteAllLinks(){const{value:e}=await Swal.fire({title:"Enter Password",input:"password",inputLabel:"Password",inputPlaceholder:"Enter Password",showCancelButton:!0,confirmButtonColor:"#212121",cancelButtonColor:"#212121",confirmButtonText:"Submit"});if("delete123"===e){const{isConfirmed:e}=await Swal.fire({title:"Delete All Links?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#212121",confirmButtonText:"Yes, delete all!",cancelButtonText:"Cancel",cancelButtonColor:"#212121"});e&&db.collection("users").get().then(e=>{const t=db.batch();return e.forEach(e=>{t.delete(e.ref)}),t.commit()}).then(()=>{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:"success",title:"All Links Deleted Successfully"}),renderLink()}).catch(e=>{console.error("Error deleting documents: ",e)})}else Swal.fire({icon:"error",title:"Access Denied",text:"Incorrect password or canceled.",confirmButtonColor:"#212121"})}document.addEventListener("DOMContentLoaded",function(){renderLink()}),document.querySelector("#deleteAllButton").addEventListener("click",deleteAllLinks),document.querySelector("#form").addEventListener("submit",addLink);
